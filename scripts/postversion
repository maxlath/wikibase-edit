#!/usr/bin/env bash

set -eu

cat package.json | jq '"
// Generated by scripts/postversion
export const name = \"\(.name)\"
export const version = \"\(.version)\"
export const homepage = \"\(.homepage)\"
export const issues = \"\(.bugs.url)\"
"' -cr > ./src/assets/metadata.ts

eslint --fix ./src/assets/metadata.ts

git add --force ./src/assets/metadata.ts
git commit --amend --no-edit

version=$(cat package.json | jq .version -cr)
tag="v${version}"
git tag -d "$tag"
git tag "$tag"
